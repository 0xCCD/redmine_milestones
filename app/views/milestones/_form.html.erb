<%= back_url_hidden_field_tag %>
<%= error_messages_for 'milestone' %>

<div class="box tabular">
  <p><%= f.text_field :name, :size => 60, :required => true %></p>
  <p><%= f.text_field :description, :size => 60 %></p>
  <p><%= f.select :kind, Milestone::MILESTONE_KINDS.collect {|s| [l("milestone_kind_#{s}"), s]}, {}, {:onchange => 'milestone_type_changed()'} %></p>
  <div id="internal_milestone_form_part">
    <p><%= f.select :project, options_for_select(Project.all.collect {|x| [x.name, x.id]}, @project.id), {}, {:onchange => "new_milestone_project_selected()"} %></p>
    <div id="subproject_placeholder" style="display:none">
        <p><%= f.select :subproject, {}, {:onchange => "new_milestone_subproject_selected()"} %></p>
    </div>
    <div id="version_placeholder">
        <p><%= f.select :version_id, @project.versions.collect {|x| [x.name, x.id]} %></p>
    </div>
  </div>
  <p><%= f.select :status, Milestone::MILESTONE_STATUSES.collect {|s| [l("version_status_#{s}"), s]} %></p>
  <p><%= f.text_field :start_date, :size => 10 %><%= calendar_for('milestone_start_date') %></p>
  <p><%= f.text_field :planned_end_date, :size => 10 %><%= calendar_for('milestone_planned_end_date') %></p>
  <p><%= f.text_field :actual_date, :size => 10 %><%= calendar_for('milestone_actual_date') %></p>
  <p><%= f.select :sharing, @milestone.allowed_sharings.collect {|v| [format_version_sharing(v), v]} %></p>
  <% @milestones = Milestone.find_all_by_project_id(@project.id) %>
  <% unless @milestones.empty? %>
    <p><%= f.select :parent_milestone, @milestones.collect {|v| [v.name, v.id]} %></p>
  <% end %>

  <p><%= f.select :user, @project.users.collect {|u| [u.name, u.id]} %></p>


</div>
<% content_for :header_tags do %>
    <%= javascript_include_tag "milestones.js", :plugin => 'redmine_milestones' %>
<% end %>